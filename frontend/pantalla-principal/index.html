<!doctype html>
<html lang="es">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon/favicon-96x96.png" />
		<link rel="icon" type="image/svg+xml" href="/assets/favicon/favicon.svg" />
		<link rel="shortcut icon" href="/assets/favicon/favicon.ico" />
		<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png" />
		<link rel="manifest" href="/assets/favicon/site.webmanifest" />
		<title>Pantalla principal | Prototipo Viva</title>
		<link rel="stylesheet" href="../assets/css/global.css" />
		<link rel="stylesheet" href="./style.css" />
	</head>
	<body>
		<header class="top-header">
			<div class="container top-header-row">
				<nav class="top-links" aria-label="Navegaci√≥n superior principal">
					<button type="button" class="ghost-link">Reservar</button>
					<button type="button" class="ghost-link">Informaci√≥n</button>
					<button type="button" class="ghost-link">Doters</button>
					<a href="../booking/" class="ghost-link is-link">Mi Reserva</a>
				</nav>
				<nav class="top-links right" aria-label="Utilidades superiores">
					<button type="button" class="ghost-link">Estatus de vuelo</button>
					<button type="button" class="ghost-link">Promociones</button>
					<button type="button" class="icon-btn" aria-label="Buscar">üîé</button>
					<button type="button" class="ghost-link">MXN</button>
					<a href="../iniciar-sesion/" class="session-btn">Iniciar sesi√≥n</a>
				</nav>
			</div>
		</header>

		<header class="main-header">
			<div class="container main-header-row">
				<div class="brand-block">
					<button type="button" class="profile-btn" aria-label="Perfil">üë§</button>
					<div>
						<div class="logo">VIVA AEROBUS</div>
						<p class="logo-sub">Sitio de reserva (prototipo)</p>
					</div>
				</div>
				<div class="main-actions">
					<a href="../crear-cuenta/" class="secondary-btn">Crear cuenta</a>
					<a href="../cart/" class="secondary-btn">Carrito</a>
					<a href="../booking/" class="primary-btn">Mi reserva</a>
				</div>
			</div>
		</header>

		<main class="container page-content">
			<section class="hero card">
				<h1>Encuentra c√≥mo viajar con Viva</h1>
				<p>
					Esta pantalla conecta tus m√≥dulos actuales. Lo disponible te lleva a pantallas reales;
					lo pendiente aparece como demostraci√≥n visual.
				</p>

				<div class="module-tabs" role="tablist" aria-label="M√≥dulos principales">
					<button class="tab-btn active" role="tab" data-tab="vuelos">Vuelos</button>
					<button class="tab-btn" role="tab" data-tab="paquetes">Paquetes</button>
					<button class="tab-btn" role="tab" data-tab="hoteles">Hoteles</button>
					<button class="tab-btn" role="tab" data-tab="autos">Autos</button>
					<button class="tab-btn" role="tab" data-tab="traslado">Traslado</button>
					<button class="tab-btn" role="tab" data-tab="eventos">Eventos</button>
				</div>

				<div class="tab-panel active" data-panel="vuelos">
					<h2>Buscador de vuelos</h2>
					<form id="flightSearch" class="search-grid">
						<div class="destination-field">
							<label for="destinationOrigin">Origen</label>
							<div id="destinationOrigin"></div>
							<input type="hidden" id="flightOriginValue" name="origin" />
						</div>
						<div class="destination-field">
							<label for="destinationTarget">Destino</label>
							<div id="destinationTarget"></div>
							<input type="hidden" id="flightDestinationValue" name="destination" />
						</div>
						<label>
							Tipo de destino
							<select id="destinationTypeFilter" class="destination-type-filter" aria-label="Filtrar destinos por tipo">
								<option value="">Todos</option>
								<option value="nacional">Nacionales</option>
								<option value="internacional">Internacionales</option>
							</select>
						</label>
						<label>
							Salida
							<input id="departDate" type="date" />
						</label>
						<label>
							Regreso
							<input id="returnDate" type="date" />
						</label>
						<label>
							Pasajeros
							<select id="passengers">
								<option value="1">1 pasajero</option>
								<option value="2">2 pasajeros</option>
								<option value="3">3 pasajeros</option>
								<option value="4">4 pasajeros</option>
							</select>
						</label>
						<div class="search-cta-wrap">
							<button type="submit" class="primary-btn full">Buscar vuelos</button>
						</div>
					</form>
					<p id="destinationStatus" class="destination-status">Escribe para buscar y selecciona una opci√≥n de la lista.</p>
				</div>

				<div class="tab-panel" data-panel="traslado">
					<h2>Traslados integrados</h2>
					<p class="panel-help">Usa estos m√≥dulos ya existentes en tu flujo.</p>
					<div class="dropdown-grid">
						<details open class="drop-card">
							<summary>
								Viva Transfer 1.0
								<span class="chip real">Disponible</span>
							</summary>
							<p>Transporte compartido aeropuerto-destino con selecci√≥n de ruta.</p>
							<a href="../results/" class="primary-btn inline">Ir al buscador de vuelos</a>
						</details>

						<details open class="drop-card">
							<summary>
								Viva Bus 1.0
								<span class="chip real">Disponible</span>
							</summary>
							<p>M√≥dulo compacto para elegir tipo de autob√∫s y confirmar selecci√≥n.</p>
							<a href="../viva-bus-1-0/" class="primary-btn inline">Abrir Viva Bus</a>
						</details>
					</div>
				</div>

				<div class="tab-panel" data-panel="paquetes">
					<h2>Paquetes</h2>
					<p class="panel-help">Vista demostrativa; a√∫n sin flujo implementado.</p>
					<div class="fake-box">
						<button type="button" class="secondary-btn fake">Vuelo + hotel</button>
						<button type="button" class="secondary-btn fake">Vuelo + auto</button>
					</div>
				</div>

				<div class="tab-panel" data-panel="hoteles">
					<h2>Hoteles</h2>
					<p class="panel-help">Vista demostrativa; a√∫n sin flujo implementado.</p>
					<div class="fake-box">
						<button type="button" class="secondary-btn fake">Buscar hotel</button>
					</div>
				</div>

				<div class="tab-panel" data-panel="autos">
					<h2>Autos</h2>
					<p class="panel-help">Vista demostrativa; a√∫n sin flujo implementado.</p>
					<div class="fake-box">
						<button type="button" class="secondary-btn fake">Rentar auto</button>
					</div>
				</div>

				<div class="tab-panel" data-panel="eventos">
					<h2>Eventos</h2>
					<p class="panel-help">Vista demostrativa; a√∫n sin flujo implementado.</p>
					<div class="fake-box">
						<button type="button" class="secondary-btn fake">Ver experiencias</button>
					</div>
				</div>
			</section>

			<section class="card split">
				<div>
					<h3>Continuar mi compra</h3>
					<p>Retoma r√°pido la etapa en la que te quedaste.</p>
					<div class="quick-links">
						<a href="../informacion-del-pasajero/" class="secondary-btn">Pasajeros</a>
						<a href="../adicionales/" class="secondary-btn">Adicionales</a>
						<a href="../pago-1-0/" class="secondary-btn">Pago</a>
					</div>
				</div>
				<div class="resume-card">
					<h4>Reserva activa</h4>
					<p>Ruta sugerida: MTY ‚Üí CDMX</p>
					<a href="../booking/" class="primary-btn inline">Abrir reserva</a>
				</div>
			</section>

			<section class="card promo-table-card">
				<h3>Comparativa promocional de transporte</h3>
				<p class="panel-help">Referencia r√°pida de precios y tiempo para planear tu viaje.</p>
				<div class="promo-table-wrap">
					<table class="promo-table">
						<thead>
							<tr>
								<th>Medio de transporte</th>
								<th>Precio aproximado (ida, MXN)</th>
								<th>Precio aproximado (ida y vuelta, MXN)</th>
								<th>Duraci√≥n estimada</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td><strong>Viva Aerobus</strong></td>
								<td>640‚Äì700</td>
								<td>1,500‚Äì1,800 ida y vuelta</td>
								<td>1 h 5 min</td>
							</tr>
							<tr>
								<td><strong>ADO (Autob√∫s)</strong></td>
								<td>385‚Äì900 (dependiendo del servicio)</td>
								<td>770‚Äì1,800 ida y vuelta</td>
								<td>6‚Äì7 h</td>
							</tr>
						</tbody>
					</table>
				</div>
			</section>

			<section class="card">
				<h3>Accesos r√°pidos</h3>
				<div class="access-grid">
					<a href="../adicionales/" class="access-item">Adicionales</a>
					<a href="../viva-bus-1-0/" class="access-item">Viva Bus</a>
					<a href="../viva-transfer-1-0/" class="access-item">Viva Transfer</a>
					<a href="../pago-1-0/" class="access-item">Pago</a>
				</div>
			</section>

			<section class="card split offers">
				<div>
					<h3>Promociones destacadas</h3>
					<div class="offer-badges">
						<span class="offer-badge">üî• Hot Sale</span>
						<span class="offer-badge">‚è∞ Tiempo limitado</span>
					</div>
					<ul>
						<li>Vuela a Canc√∫n desde MXN $999 (visual demo)</li>
						<li>C√≥digo sugerido en pago: VIVA2026</li>
						<li>Ahorra en traslado con Viva Transfer</li>
					</ul>
				</div>
				<div>
					<h3>Rutas sugeridas</h3>
					<div class="route-chips">
						<button type="button" class="chip-btn">MTY ‚Üí CDMX</button>
						<button type="button" class="chip-btn">CDMX ‚Üí CUN</button>
						<button type="button" class="chip-btn">MTY ‚Üí CUN</button>
					</div>
				</div>
			</section>
		</main>

		<footer class="site-footer">
			<div class="container footer-grid">
				<div>
					<h4>Ayuda</h4>
					<p>Centro de soporte (demo visual)</p>
				</div>
				<div>
					<h4>Contacto</h4>
					<p>atencion@viva-demo.com ¬∑ +52 55 0000 0000</p>
				</div>
				<div>
					<h4>Legales</h4>
					<p>Aviso de privacidad ¬∑ T√©rminos y condiciones</p>
				</div>
			</div>
		</footer>

		<button type="button" class="aero-bot-trigger" id="aeroBotTrigger" aria-label="Abrir chat de ayuda">
			<img src="../assets/img/aero bot.png" alt="Aero Bot" />
		</button>

		<div class="aero-bot-overlay" id="aeroBotOverlay" aria-hidden="true">
			<div class="aero-bot-modal" role="dialog" aria-modal="true" aria-labelledby="aeroBotTitle">
				<div class="aero-bot-header">
					<div>
						<h3 id="aeroBotTitle">Chatbot Viva Aerobus</h3>
						<p>Asistente con opciones r√°pidas</p>
					</div>
					<div class="aero-bot-actions">
						<button type="button" class="aero-bot-mini" id="aeroBotRestart" aria-label="Reiniciar chat">‚Üª</button>
						<button type="button" class="aero-bot-close" id="aeroBotClose" aria-label="Cerrar chat">‚úï</button>
					</div>
				</div>
				<div class="aero-bot-body" id="aeroBotMessages"></div>
				<div class="aero-bot-options" id="aeroBotOptions"></div>
			</div>
		</div>

		<script src="../assets/js/destination-dropdown.js"></script>
		<script src="./destinations-module.js"></script>
		<script>
			const tabButtons = document.querySelectorAll(".tab-btn");
			const panels = document.querySelectorAll(".tab-panel");

			tabButtons.forEach((button) => {
				button.addEventListener("click", () => {
					const selected = button.dataset.tab;

					tabButtons.forEach((tab) => tab.classList.remove("active"));
					panels.forEach((panel) => panel.classList.remove("active"));

					button.classList.add("active");
					document.querySelector(`[data-panel="${selected}"]`)?.classList.add("active");
				});
			});

			document.getElementById("flightSearch")?.addEventListener("submit", (event) => {
				event.preventDefault();
				const origin = document.getElementById("flightOriginValue")?.value?.trim();
				const destination = document.getElementById("flightDestinationValue")?.value?.trim();
				const departDate = document.getElementById("departDate")?.value || "";
				const returnDate = document.getElementById("returnDate")?.value || "";
				const passengers = document.getElementById("passengers")?.value || "1";
				const status = document.getElementById("destinationStatus");

				if (!origin || !destination) {
					if (status) {
						status.textContent = "Selecciona origen y destino para continuar con la b√∫squeda.";
					}
					return;
				}

				const payload = {
					origin,
					destination,
					departDate,
					returnDate,
					passengers,
				};

				sessionStorage.setItem("flightSearch", JSON.stringify(payload));

				const query = new URLSearchParams(payload).toString();
				window.location.href = `../results/?${query}`;
			});

			const aeroBotTrigger = document.getElementById("aeroBotTrigger");
			const aeroBotOverlay = document.getElementById("aeroBotOverlay");
			const aeroBotClose = document.getElementById("aeroBotClose");
			const aeroBotRestart = document.getElementById("aeroBotRestart");
			const aeroBotMessages = document.getElementById("aeroBotMessages");
			const aeroBotOptions = document.getElementById("aeroBotOptions");

			const chatbotFlow = {
				start: {
					bot: [
						"¬°Hola! üòä Bienvenido(a) a Viva Aerobus.",
						"Estoy aqu√≠ para acompa√±arte en tu experiencia de vuelo.",
						"¬øEs tu primera vez volando con nosotros?",
					],
					options: [
						{ label: "S√≠", next: "first_yes" },
						{ label: "No", next: "first_no" },
					],
				},
				first_yes: {
					bot: [
						"¬°Qu√© emocionante! ‚úà",
						"¬øQuieres que te comparta una gu√≠a de supervivencia para tu vuelo?",
					],
					options: [
						{ label: "S√≠, quiero la gu√≠a", next: "guide_yes" },
						{ label: "No, gracias", next: "guide_no" },
					],
				},
				first_no: {
					bot: [
						"¬°Genial! Gracias por volver a volar con nosotros üíõ",
						"Antes de continuar, ¬øtu vuelo es nacional o internacional?",
					],
					options: [
						{ label: "1‚É£ Nacional", next: "national" },
						{ label: "2‚É£ Internacional", next: "international" },
					],
				},
				guide_yes: {
					bot: [
						"Perfecto üíõ Aqu√≠ tienes tu gu√≠a b√°sica:",
						"‚Ä¢ Equipaje de mano permitido: 1 pieza de hasta 10 kg.<br>‚Ä¢ L√≠quidos: m√°ximo 100 ml por envase, en bolsa transparente.<br>‚Ä¢ Identificaci√≥n y pase de abordar listos.<br>‚Ä¢ Llega 2 horas antes al aeropuerto.<br>‚Ä¢ Usa ropa c√≥moda y lleva una chamarra ligera.",
						"Ahora cu√©ntame üëÄ ¬øTu vuelo es?",
					],
					options: [
						{ label: "1‚É£ Nacional", next: "national" },
						{ label: "2‚É£ Internacional", next: "international" },
					],
				},
				guide_no: {
					bot: [
						"Sin problema üòä",
						"¬øTu vuelo es nacional o internacional?",
					],
					options: [
						{ label: "1‚É£ Nacional", next: "national" },
						{ label: "2‚É£ Internacional", next: "international" },
					],
				},
				national: {
					bot: [
						"Perfecto ‚úà Para vuelos nacionales recuerda:",
						"‚Ä¢ Presentar identificaci√≥n oficial vigente.<br>‚Ä¢ Llegar m√≠nimo 2 horas antes.",
						"¬øQuieres que te muestre tambi√©n qu√© objetos no est√°n permitidos?",
					],
					options: [
						{ label: "S√≠", next: "not_allowed" },
						{ label: "No", next: "checkin_q" },
					],
				},
				international: {
					bot: [
						"Perfecto üåé Para vuelos internacionales te recomendamos:",
						"‚Ä¢ Revisar vigencia de pasaporte y requisitos migratorios.<br>‚Ä¢ Llegar m√≠nimo 3 horas antes.<br>‚Ä¢ Verificar equipaje documentado y restricciones del destino.",
						"¬øQuieres ver objetos no permitidos en equipaje de mano?",
					],
					options: [
						{ label: "S√≠", next: "not_allowed" },
						{ label: "No", next: "checkin_q" },
					],
				},
				not_allowed: {
					bot: [
						"No est√° permitido llevar:",
						"‚Ä¢ Objetos punzocortantes.<br>‚Ä¢ Sustancias inflamables o explosivas.<br>‚Ä¢ Bebidas alcoh√≥licas abiertas.<br>‚Ä¢ M√°s de 100 ml de l√≠quidos en equipaje de mano.",
						"¬øQuieres recibir algunos tips para pasar m√°s r√°pido el filtro de seguridad?",
					],
					options: [
						{ label: "S√≠", next: "security_tips" },
						{ label: "No", next: "checkin_q" },
					],
				},
				security_tips: {
					bot: [
						"Consejos para seguridad üö¶:",
						"‚Ä¢ Ten lista tu identificaci√≥n y pase de abordar.<br>‚Ä¢ Guarda l√≠quidos en la bolsa transparente.<br>‚Ä¢ Evita objetos met√°licos en bolsillos.<br>‚Ä¢ Lleva tu equipaje de mano ordenado.",
						"Antes de llegar al aeropuerto üëá ¬øYa hiciste tu check-in?",
					],
					options: [
						{ label: "S√≠, ya lo hice", next: "done" },
						{ label: "No, ay√∫dame", next: "checkin_help" },
					],
				},
				checkin_q: {
					bot: [
						"Antes de llegar al aeropuerto üëá ¬øYa hiciste tu check-in?",
					],
					options: [
						{ label: "S√≠, ya lo hice", next: "done" },
						{ label: "No, ay√∫dame", next: "checkin_help" },
					],
				},
				checkin_help: {
					bot: [
						"¬°Claro! üòä ¬øC√≥mo prefieres hacer tu check-in?",
					],
					options: [
						{ label: "1‚É£ Digital", next: "digital" },
						{ label: "2‚É£ En persona", next: "in_person" },
					],
				},
				digital: {
					bot: [
						"Excelente decisi√≥n üëç Es m√°s r√°pido y evitas filas.",
						"‚Ä¢ Ingresa a la app o p√°gina web.<br>‚Ä¢ Ten a la mano tu c√≥digo de reservaci√≥n.<br>‚Ä¢ Confirma tus datos.<br>‚Ä¢ Descarga tu pase de abordar en tu celular.<br>Si no documentas equipaje, podr√°s ir directo al filtro de seguridad ‚ú®",
						"üíõ Estoy aqu√≠ para que tu experiencia sea f√°cil y sin estr√©s. ¬øHay algo m√°s en lo que te pueda ayudar?",
					],
					options: [
						{ label: "S√≠, volver al inicio", next: "start" },
						{ label: "No, gracias", next: "close" },
					],
				},
				in_person: {
					bot: [
						"Perfecto üòä",
						"‚Ä¢ Llega m√≠nimo 2 horas antes si es nacional (3 horas si es internacional).<br>‚Ä¢ Dir√≠gete a mostradores o kioscos de auto check-in.<br>‚Ä¢ Ten lista tu identificaci√≥n y c√≥digo de reservaci√≥n.<br>‚Ä¢ Si documentas equipaje, entr√©galo despu√©s de obtener tu pase.",
						"üíõ Estoy aqu√≠ para que tu experiencia sea f√°cil y sin estr√©s. ¬øHay algo m√°s en lo que te pueda ayudar?",
					],
					options: [
						{ label: "S√≠, volver al inicio", next: "start" },
						{ label: "No, gracias", next: "close" },
					],
				},
				done: {
					bot: [
						"¬°Excelente! üéâ Ya llevas un gran avance.",
						"üíõ ¬øHay algo m√°s en lo que te pueda ayudar?",
					],
					options: [
						{ label: "S√≠, volver al inicio", next: "start" },
						{ label: "No, gracias", next: "close" },
					],
				},
			};

			function appendBotMessage(text) {
				const bubble = document.createElement("div");
				bubble.className = "aero-bot-msg bot";
				bubble.innerHTML = text;
				aeroBotMessages?.appendChild(bubble);
				aeroBotMessages.scrollTop = aeroBotMessages.scrollHeight;
			}

			function appendUserMessage(text) {
				const bubble = document.createElement("div");
				bubble.className = "aero-bot-msg user";
				bubble.textContent = text;
				aeroBotMessages?.appendChild(bubble);
				aeroBotMessages.scrollTop = aeroBotMessages.scrollHeight;
			}

			function renderOptions(options) {
				if (!aeroBotOptions) return;
				aeroBotOptions.innerHTML = "";

				options.forEach((option) => {
					const button = document.createElement("button");
					button.type = "button";
					button.className = "aero-bot-option";
					button.textContent = option.label;
					button.addEventListener("click", () => {
						appendUserMessage(option.label);
						if (option.next === "close") {
							appendBotMessage("¬°Gracias por usar Aero Bot! ‚úà");
							aeroBotOptions.innerHTML = "";
							return;
						}
						goToState(option.next);
					});
					aeroBotOptions.appendChild(button);
				});
			}

			function goToState(stateKey) {
				const state = chatbotFlow[stateKey];
				if (!state) return;

				state.bot.forEach((line) => appendBotMessage(line));
				renderOptions(state.options || []);
			}

			function resetChat() {
				if (aeroBotMessages) aeroBotMessages.innerHTML = "";
				if (aeroBotOptions) aeroBotOptions.innerHTML = "";
				goToState("start");
			}

			function openChat() {
				aeroBotOverlay?.classList.add("open");
				aeroBotOverlay?.setAttribute("aria-hidden", "false");
				if (!aeroBotMessages?.children.length) resetChat();
			}

			function closeChat() {
				aeroBotOverlay?.classList.remove("open");
				aeroBotOverlay?.setAttribute("aria-hidden", "true");
			}

			aeroBotTrigger?.addEventListener("click", openChat);
			aeroBotClose?.addEventListener("click", closeChat);
			aeroBotRestart?.addEventListener("click", resetChat);
			aeroBotOverlay?.addEventListener("click", (event) => {
				if (event.target === aeroBotOverlay) closeChat();
			});
		</script>
	</body>
</html>
